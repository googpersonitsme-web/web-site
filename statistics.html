<!doctype html>
<html lang="uk">
<head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta name="description" content="–°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞ —É—Å–ø—ñ—à–Ω–æ—Å—Ç—ñ">
    <title>–ñ—É—Ä–Ω–∞–ª –£—Å–ø—ñ—à–Ω–æ—Å—Ç—ñ - –°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞</title>
    <link rel="stylesheet" href="css/normalize.css">
    <link rel="stylesheet" href="style.css">
</head>
<body>
    <header>
        <div class="header">	 
            <div class="logo">	 
                <div class="logo__Text">
                    PRO100
                </div>
                <div class="logo__Image"></div>
            </div>
        </div>	 
    </header>
    
    <nav class="menu">
        <a href="index.html" class="menu__link">–ì–û–õ–û–í–ù–ê</a> | 
        <a href="students.html" class="menu__link">–°–¢–£–î–ï–ù–¢–ò</a> |
        <a href="subjects.html" class="menu__link">–ü–†–ï–î–ú–ï–¢–ò</a> |
        <a href="grades.html" class="menu__link">–û–¶–Ü–ù–ö–ò</a> |
        <a href="gallery.html" class="menu__link">–ì–ê–õ–ï–†–ï–Ø</a> |
        <a href="statistics.html" class="menu__link_active">–°–¢–ê–¢–ò–°–¢–ò–ö–ê</a>
    </nav>
    
    <main>
        <div class="grid-container">
            <div class="grid-item" style="grid-column: span 3;">
                <article>
                    <h2>–ó–∞–≥–∞–ª—å–Ω–∞ —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞</h2>
                    
                    <div class="statistics-dashboard">
                        <div class="stat-card-large">
                            <h3>–°—Ç—É–¥–µ–Ω—Ç—ñ–≤</h3>
                            <p class="stat-number-large" id="totalStudents">0</p>
                        </div>
                        <div class="stat-card-large">
                            <h3>–ü—Ä–µ–¥–º–µ—Ç—ñ–≤</h3>
                            <p class="stat-number-large" id="totalSubjects">0</p>
                        </div>
                        <div class="stat-card-large">
                            <h3>–û—Ü—ñ–Ω–æ–∫</h3>
                            <p class="stat-number-large" id="totalGrades">0</p>
                        </div>
                        <div class="stat-card-large">
                            <h3>–°–µ—Ä–µ–¥–Ω—ñ–π –±–∞–ª</h3>
                            <p class="stat-number-large" id="averageGrade">-</p>
                        </div>
                    </div>
                    
                    <h2>–†–µ–π—Ç–∏–Ω–≥ —Å—Ç—É–¥–µ–Ω—Ç—ñ–≤ –∑–∞ —Å–µ—Ä–µ–¥–Ω—ñ–º –±–∞–ª–æ–º</h2>
                    <div id="studentRanking" class="ranking-container">
                        <p>–î–∞–Ω—ñ –≤—ñ–¥—Å—É—Ç–Ω—ñ</p>
                    </div>
                    
                    <h2>–£—Å–ø—ñ—à–Ω—ñ—Å—Ç—å –ø–æ –ø—Ä–µ–¥–º–µ—Ç–∞—Ö</h2>
                    <div id="subjectStats" class="subject-stats-container">
                        <p>–î–∞–Ω—ñ –≤—ñ–¥—Å—É—Ç–Ω—ñ</p>
                    </div>
                    
                    <h2>–†–æ–∑–ø–æ–¥—ñ–ª –æ—Ü—ñ–Ω–æ–∫</h2>
                    <div id="gradeDistribution" class="grade-distribution">
                        <p>–î–∞–Ω—ñ –≤—ñ–¥—Å—É—Ç–Ω—ñ</p>
                    </div>
                    
                    <h2>–î–µ—Ç–∞–ª—å–Ω–∞ —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞ –ø–æ —Å—Ç—É–¥–µ–Ω—Ç–∞—Ö</h2>
                    <div class="filter-container">
                        <select id="filterStudentStats" class="filter-select">
                            <option value="">–û–±–µ—Ä—ñ—Ç—å —Å—Ç—É–¥–µ–Ω—Ç–∞</option>
                        </select>
                    </div>
                    <div id="studentDetails" class="student-details-container">
                        <p>–û–±–µ—Ä—ñ—Ç—å —Å—Ç—É–¥–µ–Ω—Ç–∞ –¥–ª—è –ø–µ—Ä–µ–≥–ª—è–¥—É –¥–µ—Ç–∞–ª—å–Ω–æ—ó —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–∏</p>
                    </div>
                </article>
            </div>
        </div>
    </main>
    
    <div class="grade_service">
        <div class="grade_service__column">
            <div class="grade_service__row">
                <div class="grade_service__cell1" style="flex-basis: calc(50% - 0.5px)"></div>
                <div class="grade_service__cell2" style="flex-basis: calc(50% - 0.5px)"></div>
            </div>
            <div class="grade_service__row">
                <div class="grade_service__cell3" style="flex-basis: calc(100% / 3)"></div>
                <div class="grade_service__cell4" style="flex-basis: calc(100% / 3)"></div>
                <div class="grade_service__cell5" style="flex-basis: calc(100% / 3)"></div>
            </div>
        </div>
    </div>
    
    <footer>
        <div class="footer_text">
            &#169; –ñ—É—Ä–Ω–∞–ª –£—Å–ø—ñ—à–Ω–æ—Å—Ç—ñ 2025
        </div>
    </footer>
    
    <script src="js/app.js"></script>
    <script>
        let students = JSON.parse(localStorage.getItem('students')) || [];
        let subjects = JSON.parse(localStorage.getItem('subjects')) || [];
        let grades = JSON.parse(localStorage.getItem('grades')) || [];

        document.addEventListener('DOMContentLoaded', function() {
            loadFilterStudents();
            updateGeneralStats();
            displayStudentRanking();
            displaySubjectStats();
            displayGradeDistribution();
        });

        function loadFilterStudents() {
            const filterStudent = document.getElementById('filterStudentStats');
            students.forEach(student => {
                const option = new Option(`${student.name} (${student.group})`, student.id);
                filterStudent.add(option);
            });
            
            filterStudent.addEventListener('change', function() {
                if (this.value) {
                    displayStudentDetails(parseInt(this.value));
                } else {
                    document.getElementById('studentDetails').innerHTML = '<p>–û–±–µ—Ä—ñ—Ç—å —Å—Ç—É–¥–µ–Ω—Ç–∞ –¥–ª—è –ø–µ—Ä–µ–≥–ª—è–¥—É –¥–µ—Ç–∞–ª—å–Ω–æ—ó —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–∏</p>';
                }
            });
        }

        function updateGeneralStats() {
            document.getElementById('totalStudents').textContent = students.length;
            document.getElementById('totalSubjects').textContent = subjects.length;
            document.getElementById('totalGrades').textContent = grades.length;
            
            if (grades.length > 0) {
                const average = grades.reduce((sum, grade) => sum + grade.grade, 0) / grades.length;
                document.getElementById('averageGrade').textContent = average.toFixed(2);
            }
        }

        function displayStudentRanking() {
            const container = document.getElementById('studentRanking');
            
            if (students.length === 0 || grades.length === 0) {
                container.innerHTML = '<p>–î–∞–Ω—ñ –≤—ñ–¥—Å—É—Ç–Ω—ñ</p>';
                return;
            }
            
            // –ü—ñ–¥—Ä–∞—Ö—É–Ω–æ–∫ —Å–µ—Ä–µ–¥–Ω—å–æ–≥–æ –±–∞–ª—É –¥–ª—è –∫–æ–∂–Ω–æ–≥–æ —Å—Ç—É–¥–µ–Ω—Ç–∞
            const studentAverages = students.map(student => {
                const studentGrades = grades.filter(g => g.studentId === student.id);
                const average = studentGrades.length > 0 
                    ? studentGrades.reduce((sum, g) => sum + g.grade, 0) / studentGrades.length 
                    : 0;
                return {
                    id: student.id,
                    name: student.name,
                    group: student.group,
                    average: average,
                    gradesCount: studentGrades.length
                };
            });
            
            // –°–æ—Ä—Ç—É–≤–∞–Ω–Ω—è –∑–∞ —Å–µ—Ä–µ–¥–Ω—ñ–º –±–∞–ª–æ–º
            studentAverages.sort((a, b) => b.average - a.average);
            
            let html = '<table class="ranking-table"><thead><tr><th>–ú—ñ—Å—Ü–µ</th><th>–°—Ç—É–¥–µ–Ω—Ç</th><th>–ì—Ä—É–ø–∞</th><th>–°–µ—Ä–µ–¥–Ω—ñ–π –±–∞–ª</th><th>–ö—ñ–ª—å–∫—ñ—Å—Ç—å –æ—Ü—ñ–Ω–æ–∫</th></tr></thead><tbody>';
            
            studentAverages.forEach((student, index) => {
                const medal = index === 0 ? 'ü•á' : index === 1 ? 'ü•à' : index === 2 ? 'ü•â' : '';
                const gradeClass = student.average >= 90 ? 'grade-excellent' : 
                                   student.average >= 75 ? 'grade-good' : 
                                   student.average >= 60 ? 'grade-satisfactory' : 'grade-fail';
                
                html += `
                    <tr>
                        <td><strong>${index + 1} ${medal}</strong></td>
                        <td>${student.name}</td>
                        <td>${student.group}</td>
                        <td class="${gradeClass}"><strong>${student.average.toFixed(2)}</strong></td>
                        <td>${student.gradesCount}</td>
                    </tr>
                `;
            });
            
            html += '</tbody></table>';
            container.innerHTML = html;
        }

        function displaySubjectStats() {
            const container = document.getElementById('subjectStats');
            
            if (subjects.length === 0 || grades.length === 0) {
                container.innerHTML = '<p>–î–∞–Ω—ñ –≤—ñ–¥—Å—É—Ç–Ω—ñ</p>';
                return;
            }
            
            let html = '<table class="data-table"><thead><tr><th>–ü—Ä–µ–¥–º–µ—Ç</th><th>–í–∏–∫–ª–∞–¥–∞—á</th><th>–°–µ—Ä–µ–¥–Ω—ñ–π –±–∞–ª</th><th>–ö—ñ–ª—å–∫—ñ—Å—Ç—å –æ—Ü—ñ–Ω–æ–∫</th><th>–ù–∞–π–≤–∏—â–∞ –æ—Ü—ñ–Ω–∫–∞</th><th>–ù–∞–π–Ω–∏–∂—á–∞ –æ—Ü—ñ–Ω–∫–∞</th></tr></thead><tbody>';
            
            subjects.forEach(subject => {
                const subjectGrades = grades.filter(g => g.subjectId === subject.id);
                
                if (subjectGrades.length > 0) {
                    const average = subjectGrades.reduce((sum, g) => sum + g.grade, 0) / subjectGrades.length;
                    const highest = Math.max(...subjectGrades.map(g => g.grade));
                    const lowest = Math.min(...subjectGrades.map(g => g.grade));
                    
                    const gradeClass = average >= 90 ? 'grade-excellent' : 
                                       average >= 75 ? 'grade-good' : 
                                       average >= 60 ? 'grade-satisfactory' : 'grade-fail';
                    
                    html += `
                        <tr>
                            <td><strong>${subject.name}</strong></td>
                            <td>${subject.teacher}</td>
                            <td class="${gradeClass}"><strong>${average.toFixed(2)}</strong></td>
                            <td>${subjectGrades.length}</td>
                            <td>${highest}</td>
                            <td>${lowest}</td>
                        </tr>
                    `;
                } else {
                    html += `
                        <tr>
                            <td><strong>${subject.name}</strong></td>
                            <td>${subject.teacher}</td>
                            <td colspan="4">–û—Ü—ñ–Ω–æ–∫ –Ω–µ–º–∞—î</td>
                        </tr>
                    `;
                }
            });
            
            html += '</tbody></table>';
            container.innerHTML = html;
        }

        function displayGradeDistribution() {
            const container = document.getElementById('gradeDistribution');
            
            if (grades.length === 0) {
                container.innerHTML = '<p>–î–∞–Ω—ñ –≤—ñ–¥—Å—É—Ç–Ω—ñ</p>';
                return;
            }
            
            const distribution = {
                excellent: grades.filter(g => g.grade >= 90).length,
                good: grades.filter(g => g.grade >= 75 && g.grade < 90).length,
                satisfactory: grades.filter(g => g.grade >= 60 && g.grade < 75).length,
                fail: grades.filter(g => g.grade < 60).length
            };
            
            const total = grades.length;
            
            let html = `
                <div class="distribution-chart">
                    <div class="distribution-bar">
                        <div class="bar-segment grade-excellent" style="width: ${(distribution.excellent / total * 100)}%">
                            <span>${distribution.excellent}</span>
                        </div>
                        <div class="bar-segment grade-good" style="width: ${(distribution.good / total * 100)}%">
                            <span>${distribution.good}</span>
                        </div>
                        <div class="bar-segment grade-satisfactory" style="width: ${(distribution.satisfactory / total * 100)}%">
                            <span>${distribution.satisfactory}</span>
                        </div>
                        <div class="bar-segment grade-fail" style="width: ${(distribution.fail / total * 100)}%">
                            <span>${distribution.fail}</span>
                        </div>
                    </div>
                    <div class="distribution-legend">
                        <div class="legend-item">
                            <span class="legend-color grade-excellent"></span>
                            –í—ñ–¥–º—ñ–Ω–Ω–æ (90-100): ${distribution.excellent} (${(distribution.excellent / total * 100).toFixed(1)}%)
                        </div>
                        <div class="legend-item">
                            <span class="legend-color grade-good"></span>
                            –î–æ–±—Ä–µ (75-89): ${distribution.good} (${(distribution.good / total * 100).toFixed(1)}%)
                        </div>
                        <div class="legend-item">
                            <span class="legend-color grade-satisfactory"></span>
                            –ó–∞–¥–æ–≤—ñ–ª—å–Ω–æ (60-74): ${distribution.satisfactory} (${(distribution.satisfactory / total * 100).toFixed(1)}%)
                        </div>
                        <div class="legend-item">
                            <span class="legend-color grade-fail"></span>
                            –ù–µ–∑–∞–¥–æ–≤—ñ–ª—å–Ω–æ (0-59): ${distribution.fail} (${(distribution.fail / total * 100).toFixed(1)}%)
                        </div>
                    </div>
                </div>
            `;
            
            container.innerHTML = html;
        }

        function displayStudentDetails(studentId) {
            const container = document.getElementById('studentDetails');
            const student = students.find(s => s.id === studentId);
            
            if (!student) {
                container.innerHTML = '<p>–°—Ç—É–¥–µ–Ω—Ç–∞ –Ω–µ –∑–Ω–∞–π–¥–µ–Ω–æ</p>';
                return;
            }
            
            const studentGrades = grades.filter(g => g.studentId === studentId);
            
            if (studentGrades.length === 0) {
                container.innerHTML = `<p>–£ —Å—Ç—É–¥–µ–Ω—Ç–∞ ${student.name} —â–µ –Ω–µ–º–∞—î –æ—Ü—ñ–Ω–æ–∫</p>`;
                return;
            }
            
            const average = studentGrades.reduce((sum, g) => sum + g.grade, 0) / studentGrades.length;
            
            let html = `
                <div class="student-detail-card">
                    <h3>${student.name} (${student.group})</h3>
                    <p><strong>–°–µ—Ä–µ–¥–Ω—ñ–π –±–∞–ª:</strong> ${average.toFixed(2)}</p>
                    <p><strong>–í—Å—å–æ–≥–æ –æ—Ü—ñ–Ω–æ–∫:</strong> ${studentGrades.length}</p>
                </div>
                
                <h3>–û—Ü—ñ–Ω–∫–∏ –ø–æ –ø—Ä–µ–¥–º–µ—Ç–∞—Ö:</h3>
                <table class="data-table">
                    <thead>
                        <tr>
                            <th>–ü—Ä–µ–¥–º–µ—Ç</th>
                            <th>–°–µ—Ä–µ–¥–Ω—ñ–π –±–∞–ª</th>
                            <th>–ö—ñ–ª—å–∫—ñ—Å—Ç—å –æ—Ü—ñ–Ω–æ–∫</th>
                            <th>–ù–∞–π–≤–∏—â–∞</th>
                            <th>–ù–∞–π–Ω–∏–∂—á–∞</th>
                        </tr>
                    </thead>
                    <tbody>
            `;
            
            subjects.forEach(subject => {
                const subjectGrades = studentGrades.filter(g => g.subjectId === subject.id);
                
                if (subjectGrades.length > 0) {
                    const subjectAverage = subjectGrades.reduce((sum, g) => sum + g.grade, 0) / subjectGrades.length;
                    const highest = Math.max(...subjectGrades.map(g => g.grade));
                    const lowest = Math.min(...subjectGrades.map(g => g.grade));
                    
                    const gradeClass = subjectAverage >= 90 ? 'grade-excellent' : 
                                       subjectAverage >= 75 ? 'grade-good' : 
                                       subjectAverage >= 60 ? 'grade-satisfactory' : 'grade-fail';
                    
                    html += `
                        <tr>
                            <td>${subject.name}</td>
                            <td class="${gradeClass}"><strong>${subjectAverage.toFixed(2)}</strong></td>
                            <td>${subjectGrades.length}</td>
                            <td>${highest}</td>
                            <td>${lowest}</td>
                        </tr>
                    `;
                }
            });
            
            html += '</tbody></table>';
            container.innerHTML = html;
        }
    </script>
</body>
</html>